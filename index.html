<html><!-- InstanceBegin template="/Templates/MainTemplate.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- #BeginEditable "doctitle" -->
<title>JdonFramework - DDD + CQRS + EventSourcing java reactive framework</title>  
<META NAME="Description" CONTENT="JdonFramework is a java opensource framework that supports Domain-Driven Design  DCI CQRS and Domain Events/Event Source development.">
<meta name="Keywords" content="Domain-Driven Design,DDD,EventSourcing,ES,Event,Domain Events,CQRS,CQR,DCI,Disruptor,Guava,EDA,java framework,software,freeware,free download,Domain Model,MDD,Model-Driven Development,SOA,JEE,j2ee,web,android,erp,Java,JavaEE,UML,scalable,software programs,programmer,online courses" />
<!-- #EndEditable -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<link rel="shortcut icon" href="http://www.jdon.com/favicon.ico">
<!-- InstanceBeginEditable name="head" -->

<!-- InstanceEndEditable -->
<link href="views.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#dddddd" text="#000000">
 <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center">

  <tr> 
    <td height="11" colspan="7" bgcolor="#FFFFFF" class="bianxian"> 
      <table width="100%" border="0" cellspacing="0" cellpadding="0" height="1" bordercolor="#000000">
        <tr> 
          <td> 
            <table width="100%" border="0" cellspacing="0" cellpadding="0" height="2" bgcolor="#000000">
              <tr> 
                <td></td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr> 
    
    <td bgcolor="#FFFFFF"  valign="top">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr> 
          
         
          <td valign="top" > 
            <table width="100%" border="0" cellspacing="2" cellpadding="2">
              <tr>
                <td>
                  <h1><a href="index.html">Jdon Framework</a></h1>
				<!-- #BeginEditable "main" -->                 
                  <h3 align="left">Latest News</h3>
                  <DIV 
style="BORDER-TOP-WIDTH: 2px; BORDER-LEFT-WIDTH: 2px; BORDER-BOTTOM-WIDTH: 2px; MARGIN-LEFT: 0px; BORDER-RIGHT-WIDTH: 2px">
                    <p><STRONG><a href="http://sourceforge.net/projects/jdon/files/JdonFramework/6.X_DDD/">JdonFramework_6.8  released!</a></STRONG> <strong> 10/2013</strong></p>
                    <p><a href="match.html">DDD CQRS EventSourcing example source: football Match</a></p>
                    <p><a href="ces.html"><strong>CES:Context Event and State</strong></a>                    </p>
                    <P><a href="https://github.com/banq/jdonframework/tree/master/example">JdonFramework DDD + CQRS + EventSourcing examples                    </a></P>
                    <P>Sample DEMO: <a href="http://www.jdon.com/testWeb/" target="_blank">http://www.jdon.com/testWeb/</a><br>
                      Sample  Download:<br>
                      <a href="http://sourceforge.net/projects/jdon/files/JdonFramework-App/samples-6.5/">JdonMVC+Jdon/Struts+Jdon/SpringMVC3+Jdon</a></P>
<p><a href="springIntegration.html">How to integrate Jdon Framework  with Spring</a></p>
                  </DIV>
<div class="adsensf" id="vgad336x280">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 页上左336 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-7573657117119544"
     data-ad-slot="6751585519"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>                  
                  <H3> Jdon Framework :  CQRS/DDD/ES Java Framework </H3>
                                    <DIV 
style="BORDER-TOP-WIDTH: 2px; BORDER-LEFT-WIDTH: 2px; BORDER-BOTTOM-WIDTH: 2px; MARGIN-LEFT: 0px; BORDER-RIGHT-WIDTH: 2px">
                    <P>JdonFramework is a java reactive framework that you can use to build your Domain Driven Design + CQRS + EventSource  applications with asynchronous concurrency and higher throughput.</P>
                    <P>JdonFramework = Ioc/DI/AOP + reactive Actors model</P>
<p>domain events in JdonFramework: a 
                      in-memeory model can concurrently publish events to its  subscribers.</p>
<p> JdonFramework's event engine is from <a href="http://code.google.com/p/disruptor/">Disruptor</a> that be recommended by <a href="http://martinfowler.com/articles/lmax.html">LMAX Architecture</a> wriiten by Martin Fowler. (Nothing Blocks)                    </p>
                    <p>Feature of Jdonframework: combining DCI with DDD aggregate and Domain Events.</p>
                    <p><img src="images/dcide.png" width="589" height="380" alt="dci+de"></p>
                    <p>&nbsp;</p>
                    <p>&nbsp;</p>
                    <p><strong>Domain-driven design (DDD)</strong></p>
<P> <em>Domain-driven design (DDD) is an approach to developing software for complex needs by deeply connecting the implementation to an evolving model of the core business concepts. <a href="http://en.wikipedia.org/wiki/Domain-driven_design">details</a></em>.</P>
                    <P><img src="images/dddbook.png" width="171" height="220" alt="ddd"></P>
                    <p id="body_23140068"><a href="http://www.infoq.com/interviews/Technology-Influences-DDD#">Eric Evans on How Technology Influences DDD(2012) </a></p>
                    <p>DDD's servral concepts are the Heart and Soul of OOP: </p>
                    <p> Entities and Identity, Value Objects <br>
                      Aggregate Root<br>
                      Bounded context</p>
<p>&nbsp;</p>
                    <p><strong>Reactive</strong></p>
                    <p>Reactive Programming is a hot topic , especially with such things as the <a href="http://www.reactivemanifesto.org/" target="_blank">Reactive Manifesto</a>. 
                      Reactive architecture allows developers to build systems that are event-driven(EDA), scalable, resilient and responsive: delivering highly responsive user experiences with a real-time feel, backed by a scalable and resilient application stack, ready to be deployed on multicore and cloud computing architectures.</p>
                    <p><br>
                      a reactive application is non-blocking that is under heavy load can thus have lower latency and higher throughput than a traditional application based on blocking synchronization and communication primitives.<br>
                    </p>
<P><strong>CQRS</strong></P>
<P> Command-query Responsibility Segregation      At its heart is a simple notion that you can use a different model to update information than the model you use to read information. <a href="http://martinfowler.com/bliki/CQRS.html">details</a>.</P>
<P>&nbsp;</P>
<P><strong>Domain Events</strong></P>
<P> <em>Captures the memory of something interesting which affects the domain</em>. <a href="http://martinfowler.com/eaaDev/DomainEvent.html">details</a>, see <a href="http://www.udidahan.com/2008/02/29/how-to-create-fully-encapsulated-domain-models/" rel="bookmark" title="Permanent Link: How to create fully encapsulated Domain Models">How to create fully encapsulated Domain Models</a></P>
<P>&nbsp;</P>
<P>With JdonFramework you can easily develope a <a href="http://martinfowler.com/eaaDev/EventSourcing.html" target="_blank" onMouseDown="return rwt(this,'','','','1','AFQjCNEKPs4mGoA7jGKQ5GogosnIYvkS2A','VBWdcuas7M2MSmMGaC9cGQ','0CE8QFjAA',null,event)"><em>Event Sourcing</em></a> and CQRS system.   in CQRS, by disruptor Jdon can send domain events to <a href="https://twitter.com/search/?src=hash&q=%23rabbitmq" title="#rabbitmq" data-query-source="hashtag_click"><strong>#</strong><strong><strong>rabbitmq</strong></strong></a>and <a href="https://twitter.com/search/?src=hash&q=%23zeromq" title="#zeromq" data-query-source="hashtag_click">#<strong>zeromq</strong></a> - <a href="https://twitter.com/search/?src=hash&q=%23distributed" title="#distributed" data-query-source="hashtag_click">#<strong>distributed</strong></a>.</P>
<P><a href="http://en.wikipedia.org/wiki/Data,_context_and_interaction" target="_blank">DCI:Data Context and Interactions</a>: in a Context, a Role   played by   a Data model   triggers    interaction behavior.</P>
<P><a href="http://web1.udemy.com/blog/object-oriented-programming-a-critical-approach/" target="_blank">Object Oriented Programming: A Critical Approach</a> say: OO is really about message passing:</P>
<p>&ldquo;The message-sending metaphor provides modularity by decoupling the intent of a message (embodied in its name) from the method used by the recipient to carry out the intent. Structural information is similarly protected because all access to the internal state of an object is through this same message interface.&rdquo;</p>
<P>by using jdon, a aggregate root can act as a mailbox that is a asynchronous and non-blocking event-sending and event-recipient metaphor..see below picture, more details in : <a href="http://banq.github.io/jdon/DomainEvents.html" target="_blank">Robot sample</a></P>
<P><img src="images/m.jpg" width="533" height="446" alt="modularity"></P>
<P>Event is a better interactive way for aggregate root with each other, instead of directly exposing behavior and hold references to others. and it can better protect root entity's internal state not expose. and can safely modify root's state in non-blocking way.</P>
<P><img src="images/aggregate.png" width="461" height="452" alt="aggregate root"></P>
<P><strong>Domain Events(Event Sourcing) for Evans DDD </strong>:</P>
                    <P>Real domain logic is in the Domain Model,
                      Outside the domain are these adapters, that listen to messages sent by
                      the domain. For instance, the domain could ‘broadcast’ a message(Domain Events) that a
                      new domain object has been created. An appropriate listener receives this
                      message and calls a method on a persistence service. This service knows
                      how to store the object in the database.</P>
                    <p><iframe src="http://www.slideshare.net/slideshow/embed_code/2881760" width="427" height="356" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="https://www.slideshare.net/banq/ddd-framework-for-java-jdonframework-2881760" title="DDD Framework for Java: JdonFramework" target="_blank">DDD Framework for Java: JdonFramework</a> </strong> from <strong><a href="http://www.slideshare.net/banq" target="_blank">Sunny peng</a></strong> </div>
                   
                    <P><strong>  Key  Features:</strong></P>
                    <P>&nbsp;</P>
                    <ol>
                      <li>
Domain-Driven Dsign Development, supports in-memory cache model.                    </li>
                      <li>
                        Actor model, like ErLang/scala MailBox, based on  LMAX's Disruptor , never blocks ,nothing blocks, concurrent programming;  Event-driven Architecture(EDA); asynchronous programming,concurrency pattern, lazy evaluation.</li>
                      <li>DI and AOP framework, POJO autowiring that implements Dependency Injection, and all components can be replaced, even include the framework itself. introduce any pojo as a inteceptor.</li>
                      <li> Command Query Responsibility Segregation(CQRS/CQS) , support the default implementations for CRUD and   auto paginator for query of large datas .</li>
                      <li><a href="http://en.wikipedia.org/wiki/Lazy_evaluation">Lazy loading or evaluation</a>, a aggregate root   loads its childern objects until them need to use, improving performance  by in-memory cache. memory-consumption-wise</li>
                      <li><a href="springIntegration.html">Be easily integration with Spring framework</a>.</li>
                    </ol>
                    <P>&nbsp;</P>
                    <hr>
                    <h3>getting Started</h3>
                    <p>　　　In Jdon there are two kinds of model: Component and  Model. a Component class is annotated with @Component, and a  Model class is annotated with @Model.</p>
<p> 　　When a  Model is referenced by  Component, it is a aggregate root, if it is referencedby another model, it is not a aggregate root, maybe normal Entity or Value Object.</p>
<p>  　　Model instances  live in in-memory cache, and Component instances live in the container that its lifcycle is equal to application scope.</p>
<p>　　Component can be use to implement DDD's service or other application manager, such as repository or Email sender..</p>
<p>　　Service (annotated with @Service) is same as Component, their difference is their usage, Service class services for the client, be equals to SOA service.</p>
<p>　　Jdon provide four kinds of asynchronous concurrency communication(Producer/Consumer) with these two models.</p>
<p>　　1. Component -----&gt; model</p>
<p>　　2. model -------&gt;Component</p>
<p>　　3. Compponent ------&gt; Component</p>
<p>　　4. model------&gt; model</p>
<p>　　when a Component/Service sends messages to a Domain Model(aggregate root), in CQRS we call the message is a command, and whe a domain model send message to a Component, we call it reactive  a event. see below:</p>
<p><img src="images/commandevent.png" alt="command event" width="530" height="300"></p>
<p>　　a command actions the behavior(startMatch) of a aggregate root(domain model), and a event happend in this behavior, the event will be sent to another aggregate root or a Component that maybe save it to repository.</p>
<p><img src="images/actor.png" alt="actors model" width="499" height="168"></p>
<h3>1. Component and Model</h3>
<p> 　　Component(producer with @Component) -- &gt; Model(consumer with @Model)</p>
<p>　　this mode is for CQRS's Command, one command is sent from UI, and sent to one aggregate root, one command has one action on the method of the aggregate root. this mode  works.</p>
<p>　　in this mode producer:consumer can only be 1:1, one command can only be sent to one method of one domain model. </p>
<p>　　The A in this sample is a producer with @Component:</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p>&nbsp;</p>
      <p>package com.jdon.sample.test.command;</p>
      <p>import com.jdon.annotation.model.Send;</p>
      <p>public interface AICommand {</p>
      <p> 　@<strong>Send</strong>(&quot;CommandmaTest&quot;)<br>
        　public TestCommand ma(<strong>@Receiver </strong>BModel bModel);<br>
        <br>
        }<br>
      </p>
      <p>@<strong>Component</strong>(&quot;producer&quot;)<br>
        @<strong>Introduce</strong>(&quot;componentmessage&quot;)<br>
        public class A implements AICommand {</p>
      <p> 　public TestCommand ma(BModel bModel) {<br>
        　　System.out.print(&quot;send to BModel =&quot; + bModel.getId());<br>
        　　return new TestCommand(99);<br>
        　}<br>
        }</p>
      <p></p></td>
  </tr>
</table>
<p>　　the method &quot;ma&quot; annotated with @Send must have a method parameter:BModel that annotated with @Model, that means send a command message to this domain model , the model is a receiver for a command, so must annotate with <strong>@Receiver</strong>.</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p><br>
      @<strong>Model</strong><br>
      public class BModel {<br>
      private String id;</p>
      <p> 　private int state = 100;</p>
      <p> 　public BModel(String id) {<br>
        　　super();<br>
        　　this.id = id;<br>
        　}</p>
      <p> 　@<strong>OnCommand</strong>(&quot;CommandmaTest&quot;)<br>
        　public void save(TestCommand testCommand) {<br>
        　　this.state = testCommand.getInput() + state;<br>
        　　testCommand.setOutput(state);</p>
      <p> 　}</p>
      <p> 　public String getId() {<br>
        　　return id;<br>
        　}</p>
      <p> 　public void setId(String id) {<br>
        　　this.id = id;<br>
        　}</p>
      <p>}<br>
      </p>
      <p></p></td>
  </tr>
</table>
<p>　　the topic name &quot;CommandmaTest&quot;  is  unique; because  producer : consumer is 1:1. one command has one action(onCommand). @<strong>OnCommand</strong> is annotated on the method of consumer.</p>
<p>　　the procuder(AICommand) 's ma method commands the consumer(BModel)'s save method. AICommand is a Component and BModel is a Model.</p>
<p>　　below is the client code:</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"> AppUtil appUtil = new AppUtil();<br>
AICommand a = (AICommand) appUtil.getComponentInstance(&quot;producerforCommand&quot;);<br>
BModel bModel = new BModel(&quot;one&quot;);<br>
TestCommand testCommand = a.ma(bModel);<br>
int i = 0;<br>
long start = System.currentTimeMillis();<br>
while (testCommand.getOutput() != 199) {<br>
i++;<br>
}<br>
long stop = System.currentTimeMillis();<br>
Assert.assertEquals(testCommand.getOutput(), 199);<br>
System.out.print(&quot;ok &quot; + &quot;  &quot; + (stop - start));</td>
  </tr>
</table>
<p>　　it output:</p>
<p>　　send to BModel =oneok   5</p>
<p>　　above source in :<a href="https://github.com/banq/jdonframework/tree/master/src/test/java/com/jdon/sample/test/command">https://github.com/banq/jdonframework/tree/master/src/test/java/com/jdon/sample/test/command</a></p>
<p>　　in this mode the component receives any commands from UI or others events, and handles them to a aggregate root :</p>
<p>　　UI -------&gt;commandHandler(@Component) ------&gt;aggregate root model</p>
<p> 　　in this mode, @Model is a actor and representing Aggregate Root , the state of aggregate root is changed by only single thread, it is threadsafe. and no blocking and no lock, like Actors mode of AKKA or ERlang, or like Node.js EDA. instead of 2PC or JTA, this mode can make transaction work well in high throughput way. </p>
<p>　　When we apply Jdon in a web application,  the system  works something like this:</p>
<ul>
  <li>Some command comes in to modify a given Aggregate Root (AR) entity</li>
  <li>If an @Model representing the AR is not already running in the system, create it _atomically_ (i.e. make sure you never have more than one @Model representing a specific entity)</li>
  <li>@Model should be removed after a period of idleness. This will avoid keeping actors around for entities with low interaction rates, but ensure 'hot' entities are kept in memory for performance (starting a new @Model requires loading events from an event store in order to restore the memory image representing the entity state), all these things are be done by cache in jdon. see below : @Introduce(&quot;modelCache&quot;)</li>
</ul>
<p>&nbsp;</p>
<h3>2.Model and Component</h3>
<p><strong>　　</strong>Model(producer with @Model) -- &gt; Component(consumer with @Component)</p>
<p>　　After a agrregate root (domain model) receive a command , and it will reactive a event that can be sent to a Component or another aggregate root. we call it is domain events.</p>
<p>  　　we can inject a Component(<strong>with </strong> @Component) into a agrregate root that acts as a producer.</p>
<p>　　the domain model code:</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p>@<strong>Model</strong><br>
      public class MyModel {</p>
      <p> 　private Long id;<br>
        　private String name;</p>
      <p> 　@<strong>Inject</strong> //inject the Component into this domain model<br>
        　private MyModelDomainEvent myModelDomainEvent;</p>
      <p>　public String getName() {<br>
        　　　if (this.name == null) {<br>
        　　　　DomainMessage message = myModelDomainEvent.asyncFindName(this);<br>
        　　　　this.name = (String) message.getBlockEventResult();<br>
        　　　}<br>
        　　return name;<br>
        　} </p>
      <p>....</p>
      <p>}</p></td>
  </tr>
</table>
<p>　　we inject MyModelDomainEvent into &quot;MyModel&quot; with @<strong>Inject</strong>, the injected object &quot;MyModelDomainEvent&quot; is a Component:</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p>package com.jdon.sample.test.domain.simplecase;</p>
      <p>import com.jdon.annotation.Introduce;<br>
        import com.jdon.annotation.model.Send;<br>
        import com.jdon.domain.message.DomainMessage;</p>
      <p>@<strong>Introduce</strong>(&quot;message&quot;)<br>
        public class MyModelDomainEvent {</p>
      <p> 　@<strong>Send</strong>(&quot;MyModel.findName&quot;)<br>
        　public DomainMessage asyncFindName(MyModel myModel) {<br>
        　　　return new DomainMessage(myModel);<br>
        　}</p>
      <p> 　@<strong>Send</strong>(&quot;saveMyModel&quot;)<br>
        　public DomainMessage save(MyModel myModel) {<br>
        　　　return new DomainMessage(myModel);<br>
        　}</p>
      <p>}<br>
      </p></td>
  </tr>
</table>
<p>　　MyModelDomainEvent is annotated with @<strong>Introduce</strong>(&quot;message&quot;),  in this producer class there are two topic that means two kinds of domain events.</p>
<p>　　let's see how to implement a consumer for a domain event. the consumer is too a Component, see below:</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p>@<strong>Consumer</strong>(&quot;MyModel.findName&quot;)<br>
      public class FindNameListener implements <strong>DomainEventHandler</strong> {</p>
      <p> 　public void <strong>onEvent</strong>(EventDisruptor event, boolean endOfBatch) throws Exception {<br>
        　　MyModel myModel = (MyModel) event.getDomainMessage().getEventSource();<br>
        　　System.out.println(&quot;Asynchronous eventMessage=&quot; + myModel.getId());<br>
        　　event.getDomainMessage().setEventResult(&quot;Asynchronous eventMessage=&quot; + myModel.getId());<br>
        　}<br>
        }<br>
      </p></td>
  </tr>
</table>
<p>　　FindNameListener is annotated with @<strong>Consumer</strong>, not @<strong>Component</strong>, this is another consumer style, when using @<strong>Consumer</strong>, we need implement a interface <strong>DomainEventHandler</strong>, and implement its method <strong>onEvent</strong>, if we using @<strong>Component</strong>, we need use @<strong>OnEvent</strong> together.</p>
<p>　　above consumer is for the producer @<strong>Send</strong>(&quot;MyModel.findName&quot;), another consumer for this producer @<strong>Send</strong>(&quot;saveMyModel&quot;) of this sample uses @Component and @OnEvent:</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p>@<strong>Component</strong>(&quot;mymrepository&quot;)<br>
      @Introduce(&quot;modelCache&quot;)<br>
      public class RepositoryImp implements MyModelRepository {</p>
      <p> 　@Around<br>
        　public MyModel getModel(Long key) {<br>
        　　　MyModel mym = new MyModel();<br>
        　　　mym.setId(key);<br>
        　　　return mym;<br>
        　}</p>
      <p> 　@<strong>OnEvent</strong>(&quot;saveMyModel&quot;)<br>
        　public void save(MyModel myModel) {<br>
        　　　System.out.print(&quot;\n No.1 @OnEvent:&quot; + this.getClass().getName());</p>
      <p> 　}</p>
      <p>}</p></td>
  </tr>
</table>
<p>　　this consumer is a class RepositoryImp that it is a Repository of DDD, and it also fetch a aggregate root from repository, @Introduce(&quot;modelCache&quot;) and @Around enable in-memory cache before the database. only when there is no the model object in cache, it will got from the database. @Introduce(&quot;modelCache&quot;) and @Around is necessary for using jdon framework. if not use them, any domain events will disable.</p>
<p>　　another way,we can call com.jdon.domain.dci.RoleAssigner assignAggregateRoot method to let any normal object be act as a aggregate root.</p>
<p>　　the in-memory cache make Aggregate Root living in memory, you can configure any cache product(ehcache, Redis ) for it. ensure 'hot' entities are kept in memory for performance.</p>
<p>　　we have known about two interactive modes between Component and aggregate root, if using these two modes in a aggregate root, it can be regarded as a Actors mode like Akka or Erlang: </p>
<ul>
  <li>    Share NOTHING, </li>
  <li>Isolated lightweight event-based processes,  </li>
  <li>Each actor has a mailbox (message queue, in jdon it is Disruptor of LMAX)<br>
    </li>
  <li>Communicates through asynchronous&amp;  non-blocking message passing</li>
  </ul>
<p>　　above sources: <a href="https://github.com/banq/jdonframework/tree/master/src/test/java/com/jdon/sample/test/domain/simplecase">https://github.com/banq/jdonframework/tree/master/src/test/java/com/jdon/sample/test/domain/simplecase</a></p>
<p>&nbsp;</p>
<h3>3.Component and Component</h3>
<p><strong>　　</strong>Component(producer with @Component) -- &gt; Component(consumer with @Component)</p>
<p>　　in this mode there are two ways:</p>
<p>　　1. dependency inject </p>
<p>　　2. producer and consumer based on Event.</p>
<p>　　Dependency inject is like IOC, Jdon only supports class construtor inject:</p>
<table width="650" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p>&nbsp;</p>
      <p>@Component<br />
        public class A{</p>
      <p>　　private B b;</p>
      <p>　　//inject b instance<br />
        　　public A(B b){<br />
        　　　　this.b = b;<br />
        　　} <br />
        }</p>
      <p>@Component<br />
        public class B{</p>
      <p>}</p>
      <p></p></td>
  </tr>
</table>
<p>　　after B was injected into A, A can directly invoke any B's method. another way is more loose couple,between A and B there are communicates through asynchronous&amp;  non-blocking message passing  .</p>
<p>　　The A in this sample is a producer with @Component:</p>
<p>&nbsp;</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p>&nbsp;</p>
      <p>package com.jdon.sample.test.event;</p>
      <p>import com.jdon.annotation.model.Send;</p>
      <p>public interface AI {</p>
      <p>　　@<strong>Send</strong>(&quot;maTest&quot;)<br>
        　　public TestEvent ma();<br>
        }</p>
      <p>&nbsp;</p>
      <p>@<strong>Component</strong>(&quot;producer&quot;)<br>
        @<strong>Introduce</strong>(&quot;componentmessage&quot;)<br>
        public class A implements AI {</p>
      <p> 　public TestEvent ma() {<br>
        　　System.out.print(&quot;event.send.ma..&quot;);<br>
        　　return new TestEvent(99);<br>
        　}<br>
        }</p>
      <p></p></td>
    </tr>
</table>
<p>　　The B in this sample is a consumer with @Component, and its consumer method must be annotated with @<strong>OnEvent</strong>,</p>
<p>&nbsp;</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p>&nbsp;</p>
      <p>@<strong>Component</strong>(&quot;consumer&quot;)<br>
        public class B {</p>
      <p> 　@<strong>OnEvent</strong>(&quot;maTest&quot;)<br>
        　public void mb(TestEvent testEvent) throws Exception {<br>
        　　testEvent.setResult(testEvent.getS() + 1);//the consumer return a result to the procuder<br>
        　　System.out.print(&quot;event.@OnEvent.mb..&quot; + testEvent.getResult() + &quot;\n&quot;);<br>
        　　Assert.assertEquals(testEvent.getResult(), 100);<br>
        　}<br>
        }</p>
<p></p></td>
  </tr>
</table>
<p>　　the value &quot;maTest&quot; of @<strong>OnEvent</strong> must be same as the value of @<strong>Send</strong>. and the return type &quot;TestEvent&quot; of the method with @<strong>Send</strong> must be same as the input paramter type of the @<strong>OnEvent</strong>, so the producer can handle a object to the consumer.</p>
<p>　　if the consumer want to return a result to the producer, recommend to use method setEventResult of <a href="https://github.com/banq/jdonframework/blob/master/src/main/java/com/jdon/domain/message/DomainMessage.java" target="_blank">com.jdon.domain.message.DomainMessage</a>, and the producer can fetch the result by its getBlockEventResult() or getEventResult(), getBlockEventResult() can block until get the result.</p>
<p>&nbsp;</p>
<p>　　Test client code:</p>
<table width="750" border="0">
  <tr>
    <td bgcolor="#CCCCCC"><p>&nbsp;</p>
      <p>&nbsp;</p>
      <p> AppUtil appUtil = new AppUtil();<br>
        AI a = (AI) appUtil.getService(&quot;producer&quot;);<br>
        TestEvent te = a.ma();<br>
        long start = System.currentTimeMillis();<br>
        while (te.getResult() != 100) {<br>
        }<br>
        long stop = System.currentTimeMillis();</p>
      <p> Assert.assertEquals(te.getResult(), 100);<br>
        System.out.print(&quot;ok &quot; + &quot;  &quot; + (stop - start) + &quot;\n&quot;);</p>
      <p></p>
<p></p></td>
  </tr>
</table>
<p>　　output:</p>
<p> 　　[junit] event.send.ma..event.@OnEvent.mb..100<br>
　　[junit] ok   31</p>
<p>　　above codes is from<a href="https://github.com/banq/jdonframework/tree/master/src/test/java/com/jdon/sample/test/event">https://github.com/banq/jdonframework/tree/master/src/test/java/com/jdon/sample/test/event</a></p>
<p>&nbsp;</p>
<h3>4.Model and Model</h3>
<p><strong>　　</strong>Model(aggregate root A) -- &gt; Model(aggregate root B)</p>
<p>　　Aggregates
  are
  always
  internally
  consistent, and Aggregates&quot;eventually
  consistent&quot;  with
  each
  other.
  – Asynchronous<br>
  updates
  propagate
  through
  system,References are 
  limited
  to
  aggregate
  roots.</p>
<p>　　when a aggregates root want to cal another aggregates root , it only can be implemented by domain events, a output event act as a input command for another aggregates root.</p>
<p>　　this mode consists of  three modes above:</p>
<p>　　1. Aggrgate root A reactive a event to a Component (model ---&gt; Component)</p>
<p>　　2.the Component transfer the event to a command for Aggrgate root B (Component ----&gt;Component)</p>
<p>　　3.the command will be sent to Aggrgate root B (component --&gt;model)</p>
<p>　　this mode's source code is in Github: <a href="https://github.com/banq/jdonframework/tree/master/src/test/java/com/jdon/sample/test/cqrs" target="_blank">https://github.com/banq/jdonframework/tree/master/src/test/java/com/jdon/sample/test/cqrs</a></p>
<div> </div>

                    <hr>
                    <H3>Blog</H3>
                    <p><a href="match.html">DDD CQRS EventSourcing example source: football Match</a></p>
                    <p><a href="ces.html"> CES:Context Event and State </a></p>
                    <p> <a href="DomainEvents.html">DDD  DCI  and DomainEvents example </a></p>
                    <p><a href="dci.html">how to enhance Jdon framework to DCI framework ? </a></p>
                    <p><a href="Immutability.html">Immutability is Easy </a></p>
                    <p><a href="non-blocking.html">how to easily develop a non-blocking concurrent application ? </a></p>
                    <p>&nbsp;</p>
<H4>History</H4>
                  </DIV>
                  <DIV 
style="BORDER-TOP-WIDTH: 2px; BORDER-LEFT-WIDTH: 2px; BORDER-BOTTOM-WIDTH: 2px; MARGIN-LEFT: 0px; BORDER-RIGHT-WIDTH: 2px">
                    <P>Jdon framework  was submitted to sf.net in Dec 2004.
                    and release a stable and mature version in JUN 2005. until Jdon Framework 6.2 released in 2009, JF is truly stableDDD framework for java. </P>
                    <h4>Others resources                    </h4>
                    <p><a href="http://www.javacodegeeks.com/2013/06/the-biggest-flaw-of-spring-web-applications.html" title="Permalink to The Biggest Flaw of Spring Web Applications" target="_blank" rel="bookmark">The Biggest Flaw of Spring Web Applications</a>                    </p>
                    <p><a href="http://www.javacodegeeks.com/2012/08/single-writer-principle.html">Single Writer Principle</a>                    </p>
                    <p><a href="http://www.reactivemanifesto.org/" target="_blank">The Reactive Manifesto</a></p>
                    <p><a href="http://www.slideshare.net/jeppec/what-soa-eda-and-cqrs-version" target="_blank">What do your SOA have</a>?</p>
                    <p><a href="http://books.google.com/books?id=X7DpD5g3VP8C&pg=PT9&hl=zh-CN&source=gbs_toc_r#v=onepage&q&f=false" target="_blank">Book Review: Implementing Domain-Driven Design</a></p>
<p><a href="http://msdn.microsoft.com/en-us/library/jj554200.aspx" target="_blank">MSDN:DDD+CQRS</a></p>
                  </DIV>
                  <DIV 
style="BORDER-TOP-WIDTH: 2px; BORDER-LEFT-WIDTH: 2px; BORDER-BOTTOM-WIDTH: 2px; MARGIN-LEFT: 0px; BORDER-RIGHT-WIDTH: 2px"></DIV>
                  <!-- 
		<section>
			<title>News and events</title>
			<ul>
				<li>
					<link href="http://apachecon.com/2003/US/index.html">
						<img src="http://jakarta.apache.org/images/logos/ac2003-150.gif" alt="apachecon 2003 logo" width="150" height="86"/>
					</link>
					<link href="http://apachecon.com/2003/US/index.html">ApacheCon US 2003</link>
			          (16-19 November 2003) is now open for registration. ApacheCon is
			          the conference for all things Apache. Come along and learn about
			          a range of new technologies, meet some Apache folks and share
			          the knowledge. David Bau is scheduled to speak about XMLBeans 
			          on Monday, Nov 17 from 2:30 to 3:30 
			          (<link href="http://apachecon.com/2003/US/html/sessions.html">ApacheCon Schedule</link>).
			        </li>
			</ul>
		</section>
		-->
        <a href='http://www.pledgie.com/campaigns/18602'><img alt='Click here to lend your support to: Jdonframework and make a donation at www.pledgie.com !' src='http://www.pledgie.com/campaigns/18602.png?skin_name=chrome' border='0' /></a>
                  <p>contact me: banQ<img src="images/email23ghsd486-(%5Ek.gif">163.com or twiiter:<a href="https://twitter.com/jdonframework" target="_blank"> @jdonframework  </a> or <a href="https://github.com/banq/jdonframework" target="_blank">GitHub </a></p>
                  <p>&nbsp;</p>
                <!-- #EndEditable -->
                  <div class="adsensf" id="vgad336x280">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 页上左336 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-7573657117119544"
     data-ad-slot="6751585519"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 页上左336 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-7573657117119544"
     data-ad-slot="6751585519"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</div>         
			    </td>
              </tr>
            </table>			
          </td>
		  <td width="200" valign="top"  bgcolor="#FFFFD7"> <table width="100%" border="0" cellspacing="0" cellpadding="3" height="200" align="center">
      <tr>
        <td align="right"><table width="100%" height="200" border="0" align="center" cellpadding="3" cellspacing="0" dwcopytype="CopyTableCell">
            <tr>
              <td align="left"  valign="top"><p align="center"><a href="http://http://banq.github.io/jdon/"><img src="images/jdone.gif" width="120" height="60" border="0"></a></p>
                  <p ><B><a href="https://sourceforge.net/projects/jdon/files/" target="_blank">Download</a></B>                  </p>
                  <p ><B><a href="doc.htm" target="_blank">Document</a></B></p>
                  <p ><a href="quickconf.html"><strong>Qucik Start</strong></a> </p>
                  <p ><a href="https://github.com/banq/jdonframework/tree/master/example" target="_blank"><strong>Examples</strong></a></p>
                  <p ><a href="https://github.com/banq/jdonframework"><strong>Github</strong></a></p>
<p ><B><a href="http://sourceforge.net/projects/jdon/files/jivejdon/4.x/" target="_blank">jivejdon</a></B></p>
                  <p ><a href="http://code.google.com/p/jdonmvc/downloads/list"><strong>JdonMVC</strong></a></p>
                  <p ><a href="http://www.jdon.com/jdonframework/"><strong>Jdon中文</strong></a></p>
<p ><a href="http://sourceforge.net/projects/jdon/"><img src="images/sf.gif" alt="sf" width="88" height="31" border="0"></a></p>

<p >
<a href='http://www.pledgie.com/campaigns/18602'><img alt='Click here to lend your support to: Jdonframework and make a donation at www.pledgie.com !' src='http://www.pledgie.com/campaigns/18602.png?skin_name=chrome' border='0' /></a></p>
<p ><a class="coinbase-button" data-code="3733678170b157113db389c0645dfaad" data-button-style="donation_large" href="https://coinbase.com/checkouts/3733678170b157113db389c0645dfaad">Donate Bitcoins</a><script src="https://coinbase.com/assets/button.js" type="text/javascript"></script></p>
<p >Twitter:
<br ><a href="https://twitter.com/jdonframework" target="_blank"><strong>@jdonframework</strong></a></p>
                  <!-- InstanceBeginEditable name="Menu" --> <!-- InstanceEndEditable --> </td>
            </tr>
        </table></td>
        </tr>
      </table>
   </td>
      </tr>
    </table></td>
  </tr>
</table>


<table width="100%" border="0" cellspacing="0" cellpadding="0" height="2" bgcolor="#000000"  align="center">
              <tr>
                <td></td>
              </tr>
</table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center">
<tr><td height="20" bgcolor="#CAC9BB" align="center">
  <p><span class="small"><font color="#555555"><br>
  </font></span></p>
  </td>
</tr>
</table>
<br>
<!-- InstanceBeginEditable name="EditRegion3" --><!-- InstanceEndEditable -->
</body>
<!-- InstanceEnd --></html>
